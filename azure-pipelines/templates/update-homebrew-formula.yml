  
#parameters:
#  GitHubConnection: "" # defaults for any parameters that aren't specified

resources:
  repositories:
  - repository: BedrockHomebrewCore # The name used to reference this repository in the checkout step
    type: github
    endpoint: edaena
    name: edaena/homebrew-core

jobs:
  - job: Create_Github_Release
    timeoutInMinutes: 30 # timeout on job if deploy is not completed in 30 minutes
    pool:
      vmImage: ubuntu-16.04
    steps:
      - checkout: self
      - checkout: BedrockHomebrewCore
        persistCredentials: true
        clean: true
      - script: |
          dir $(Build.SourcesDirectory)
          echo "ls:"
          ls
          echo "pwd:"
          pwd
          cd homebrew-core
          git pull origin master
          git checkout -b master
          # Set git identity
          git config user.email "admin@azuredevops.com"
          git config user.name "Automated Account"
          touch readme2.md
          git branch update2
          git checkout update2
          #git pull origin update2
          sha_number="testsha9d"
          release_url="https:\/\/hi.com"
          echo "ls"
          ls
          cd Formula
          sed "s/url \".*\"/url \"$release_url\"/g" bedrock-cli.rb > bedrock-cli.rb
          sed "s/sha256 \".*\"/sha256 \"$sha_number\"/g" bedrock-cli.rb > bedrock-cli.rb
          echo bedrock-cli.rb
          git add -f bedrock-cli.rb
          git commit -m "Update formula"
          git push origin update2
          #git push origin master
      